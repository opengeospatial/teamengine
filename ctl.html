<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.7.4 at 2023-12-18 
 | Rendered using Apache Maven Fluido Skin 1.6
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20231218" />
    <meta http-equiv="Content-Language" content="en" />
    <title>TEAM Engine &#x2013; CTL scripts</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.6.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
      <script type="text/javascript" src="./js/apache-maven-fluido-1.6.min.js"></script>
      </head>
    <body class="topBarDisabled">
      <div class="container-fluid">
      <div id="banner">
        <div class="pull-left"><a href="https://github.com/opengeospatial/teamengine" id="bannerLeft"><img src="./images/te-logo-small.png"  alt="TEAM Engine"/></a></div>
        <div class="pull-right"><a href="http://www.osgeo.org/incubator" id="bannerRight"><img src="./images/OSGeo_incubation.png"  alt="OSGeo Incubator"/></a></div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2023-12-18<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 5.7</li>
      <li class="pull-right"><span class="divider">|</span>
<a href="https://github.com/opengeospatial/teamengine/issues" class="externalLink" title="Issues">Issues</a></li>
      <li class="pull-right"><a href="https://github.com/opengeospatial/teamengine/wiki" class="externalLink" title="Wiki">Wiki</a></li>
        </ul>
      </div>
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
<ul class="nav nav-list">
          <li class="nav-header">Getting Started</li>
    <li><a href="index.html" title="Overview"><span class="none"></span>Overview</a>  </li>
    <li><a href="definitions.html" title="Definitions"><span class="none"></span>Definitions</a>  </li>
    <li><a href="installation.html" title="Installation"><span class="none"></span>Installation</a>  </li>
    <li><a href="users.html" title="User's Guide"><span class="none"></span>User's Guide</a>  </li>
    <li><a href="virt-guide.html" title="Virtualization Guide"><span class="none"></span>Virtualization Guide</a>  </li>
          <li class="nav-header">Test Suite Development</li>
    <li><a href="testng-essentials.html" title="Using TestNG, Part 1: Essentials"><span class="none"></span>Using TestNG, Part 1: Essentials</a>  </li>
    <li><a href="testng-cookbook.html" title="Using TestNG, Part 2: Cookbook"><span class="none"></span>Using TestNG, Part 2: Cookbook</a>  </li>
    <li class="active"><a href="#"><span class="none"></span>Using CTL Scripts</a>
  </li>
    <li><a href="encoding-conformance-classes.html" title="Encoding Conformance Classes"><span class="none"></span>Encoding Conformance Classes</a>  </li>
    <li><a href="profiles-guide.html" title="Application Profiles"><span class="none"></span>Application Profiles</a>  </li>
          <li class="nav-header">About</li>
    <li><a href="relnotes.html" title="Release Notes"><span class="none"></span>Release Notes</a>  </li>
  </ul>
          <hr />
          <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
  <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
              </div>
          </div>
        </div>
        <div id="bodyColumn"  class="span9" >
<h1>CTL scripts</h1>
<p>The OGC test harness is capable of running tests implemented using the CTL (<a class="externalLink" href="http://portal.opengeospatial.org/files/?artifact_id=33085">Compliance Test Language</a>) scripting language developed by the OGC. The CTL grammar can be regarded as a kind of XML-based domain-specific language for defining test suites. A test suite is processed to produce XSLT 2.0 templates that are then executed by the Saxon 9.0 XSLT processor as shown in the following figure.</p>
<p><b>Figure 1:</b> Executing CTL scripts</p>
<p><img src="images/ctl-execution.png" alt="Executing CTL scripts" /></p>
<p>The teamengine-core-\${project.version}-base.zip archive contains a sample test suite in <tt>scripts/note/1.0/ctl/note.ctl</tt>. The OGC compliance testing program also maintains a set of test suites that are publicly available from GitHub at this location: <a class="externalLink" href="https://github.com/opengeospatial">https://github.com/opengeospatial</a>.</p>
<div class="section">
<h2><a name="Grouping_tests"></a>Grouping tests</h2>
<p>If one ctl:code element is used to execute multiple tests, failures in subtests can lead to confusing test results.</p>
<p>For example, this piece of ctl code:</p>

<div class="source">
<div class="source"><pre class="prettyprint">&lt;ctl:test name=&quot;Test&quot;&gt;
    &lt;ctl:code&gt;
       &lt;ctl:call-test name=&quot;Subtest&quot;&gt;
       &lt;/ctl:call-test&gt;
       &lt;xsl:if test=&quot;assertion 1&quot;&gt;
         &lt;ctl:message&gt;[FAILURE] 1.&lt;/ctl:message&gt;
         &lt;ctl:fail/&gt;
       &lt;/xsl:if&gt;

       &lt;ctl:call-test name=&quot;Subtest&quot;&gt;
       &lt;/ctl:call-test&gt;
       &lt;xsl:if test=&quot;assertion 2&quot;&gt;
         &lt;ctl:message&gt;[FAILURE] 2.&lt;/ctl:message&gt;
         &lt;ctl:fail/&gt;
       &lt;/xsl:if&gt;
    &lt;/ctl:code&gt;
&lt;/ctl:test&gt;

&lt;ctl:test name=&quot;Subtest&quot;&gt;
    &lt;ctl:code&gt;
       &lt;xsl:if test=&quot;assertion 3&quot;&gt;
         &lt;ctl:message&gt;[FAILURE] 3.&lt;/ctl:message&gt;
         &lt;ctl:fail/&gt;
       &lt;/xsl:if&gt;
    &lt;/ctl:code&gt;
&lt;/ctl:test&gt;
</pre></div></div>
<p>The test Subtest is called twice, e.g. evaluating some common prerequisites for assertion 1 and 2.</p>
<p>If assertion 2 would evaluate to true, thus causing a ctl:fail, the following HTML report would be generated:</p>
<p><img src="images/ctl-subtests-misleading.png" alt="TestNG results summary" /></p>
<p>No information would be given regarding the reason of failure. The ctl:message would only be found in the logs.</p>
<p>This can be confusing for users of the test suite.</p>
<p>As a good practice, we would suggest to create different Subtests that include the assertions of the xsl:if statements.</p>

<div class="source">
<div class="source"><pre class="prettyprint">&lt;ctl:test name=&quot;Test&quot;&gt;
    &lt;ctl:code&gt;
       &lt;ctl:call-test name=&quot;Subtest 1&quot;&gt;
       &lt;/ctl:call-test&gt;

       &lt;ctl:call-test name=&quot;Subtest 2&quot;&gt;
       &lt;/ctl:call-test&gt;
    &lt;/ctl:code&gt;
&lt;/ctl:test&gt;

&lt;ctl:test name=&quot;Subtest 1&quot;&gt;
    &lt;ctl:code&gt;
       &lt;xsl:if test=&quot;assertion 3&quot;&gt;
         &lt;ctl:message&gt;[FAILURE] 3.&lt;/ctl:message&gt;
         &lt;ctl:fail/&gt;
       &lt;/xsl:if&gt;
       &lt;xsl:if test=&quot;assertion 1&quot;&gt;
         &lt;ctl:message&gt;[FAILURE] 1.&lt;/ctl:message&gt;
         &lt;ctl:fail/&gt;
       &lt;/xsl:if&gt;
    &lt;/ctl:code&gt;
&lt;/ctl:test&gt;

&lt;ctl:test name=&quot;Subtest 2&quot;&gt;
    &lt;ctl:code&gt;
       &lt;xsl:if test=&quot;assertion 3&quot;&gt;
         &lt;ctl:message&gt;[FAILURE] 3.&lt;/ctl:message&gt;
         &lt;ctl:fail/&gt;
       &lt;/xsl:if&gt;
       &lt;xsl:if test=&quot;assertion 2&quot;&gt;
         &lt;ctl:message&gt;[FAILURE] 2.&lt;/ctl:message&gt;
         &lt;ctl:fail/&gt;
       &lt;/xsl:if&gt;
    &lt;/ctl:code&gt;
&lt;/ctl:test&gt;
</pre></div></div>
<p>Now, if assertion 2 would evaluate to true, the following HTML report would be generated:</p>
<p><img src="images/ctl-subtests-good-practice.png" alt="TestNG results summary" /></p>
<p>Now the source of the error can be investigated further by clicking on the failed Subtest 2.</p></div>
        </div>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>Copyright &copy;2023
<a href="http://www.opengeospatial.org/">Open Geospatial Consortium</a>.
All rights reserved.</p>
        </div>
        </div>
    </footer>
    </body>
</html>