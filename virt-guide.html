<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.11.1 at 2024-11-07 
 | Rendered using Apache Maven Fluido Skin 1.6
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Creation-yyyymmdd" content="20241107" />
    <meta name="Date-Revision-yyyymmdd" content="20241107" />
    <meta http-equiv="Content-Language" content="en" />
    <title>TEAM Engine &#x2013; Virtualization Guide</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.6.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
      <script type="text/javascript" src="./js/apache-maven-fluido-1.6.min.js"></script>
      </head>
    <body class="topBarDisabled">
      <div class="container-fluid">
      <div id="banner">
        <div class="pull-left"><a href="https://github.com/opengeospatial/teamengine" id="bannerLeft"><img src="./images/te-logo-small.png"  alt="TEAM Engine"/></a></div>
        <div class="pull-right"><a href="http://www.osgeo.org/incubator" id="bannerRight"><img src="./images/OSGeo_incubation.png"  alt="OSGeo Incubator"/></a></div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2024-11-07<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 6.0.0-RC2</li>
      <li class="pull-right"><span class="divider">|</span>
<a href="https://github.com/opengeospatial/teamengine/issues" class="externalLink" title="Issues">Issues</a></li>
      <li class="pull-right"><a href="https://github.com/opengeospatial/teamengine/wiki" class="externalLink" title="Wiki">Wiki</a></li>
        </ul>
      </div>
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
<ul class="nav nav-list">
          <li class="nav-header">Getting Started</li>
    <li><a href="index.html" title="Overview"><span class="none"></span>Overview</a>  </li>
    <li><a href="definitions.html" title="Definitions"><span class="none"></span>Definitions</a>  </li>
    <li><a href="installation.html" title="Installation"><span class="none"></span>Installation</a>  </li>
    <li><a href="users.html" title="User's Guide"><span class="none"></span>User's Guide</a>  </li>
    <li class="active"><a href="#"><span class="none"></span>Virtualization Guide</a>
  </li>
          <li class="nav-header">Test Suite Development</li>
    <li><a href="testng-essentials.html" title="Using TestNG, Part 1: Essentials"><span class="none"></span>Using TestNG, Part 1: Essentials</a>  </li>
    <li><a href="testng-cookbook.html" title="Using TestNG, Part 2: Cookbook"><span class="none"></span>Using TestNG, Part 2: Cookbook</a>  </li>
    <li><a href="ctl.html" title="Using CTL Scripts"><span class="none"></span>Using CTL Scripts</a>  </li>
    <li><a href="encoding-conformance-classes.html" title="Encoding Conformance Classes"><span class="none"></span>Encoding Conformance Classes</a>  </li>
    <li><a href="profiles-guide.html" title="Application Profiles"><span class="none"></span>Application Profiles</a>  </li>
          <li class="nav-header">About</li>
    <li><a href="relnotes.html" title="Release Notes"><span class="none"></span>Release Notes</a>  </li>
  </ul>
          <hr />
          <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
  <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
              </div>
          </div>
        </div>
        <div id="bodyColumn"  class="span9" >
<h1>Virtualization Guide</h1>
<div class="sect1">
<h2 id="introduction">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This guide describes how to use <a href="https://www.packer.io/">Packer</a> to create a virtual machine (VM)
or container image that includes a complete TEAM Engine installation along with the latest OGC
conformance test suites. The generated image will contain the software components shown in the
following figure (<a href="#teamengine-vm">Software installed in the image</a>).</p>
</div>
<div id="teamengine-vm" class="imageblock text-center">
<div class="content">
<img src="./images/teamengine-vm.png" alt="software components"/>
</div>
<div class="title">Figure 1. Software installed in the image</div>
</div>
<div class="paragraph">
<p>Packer is an open-source infrastructure definition tool used to create images for a variety of
dynamic infrastructure platforms. It includes builders for many virtual environments, such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>VirtualBox</p>
</li>
<li>
<p>Amazon EC2</p>
</li>
<li>
<p>VMware vSphere</p>
</li>
<li>
<p>Google Compute Engine</p>
</li>
<li>
<p>Docker (container)</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Virtual machine vs. container</div>
<div class="paragraph">
<p>A container is not a full-blown virtual machine&#8212;&#8203;it doesn&#8217;t require a hypervisor and runs in
an isolated environment provided by a single host operating system. Since the OS kernel is
shared, a container generally has less overhead than a virtual machine. Container technologies
such as Docker, Warden, and Rocket offer a way to package and distribute a service or an
application along with its dependencies.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>The build process is driven by a template: a configuration file (in JSON format) that defines
how a machine image is created and provisioned. Several Packer templates have been developed for
various virtualization environments; these are available in the teamengine-virtualization module.
An archive file containing the source code for the <a href="https://github.com/opengeospatial/teamengine/releases/latest">latest release</a>
can be downloaded from GitHub (or try the <a href="https://github.com/opengeospatial/teamengine/archive/master.zip">current snapshot</a>).
Unpack the archive in a convenient location. The Packer templates can be found in this
subdirectory: <code>teamengine-virtualization/src/main/config/packer/</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="packer">Packer</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To install Packer, download the appropriate <a href="https://www.packer.io/downloads.html">binary package</a>
for your host environment. Packages are available for all major operating systems (Windows, macOS,
and Linux). Unpack the archive in a suitable directory, and then set the following user environment
variables:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">PACKER_HOME</dt>
<dd>
<p>The directory where Packer is installed (Example: /usr/local/bin)</p>
</dd>
<dt class="hdlist1">PACKER_CACHE_DIR</dt>
<dd>
<p>(Optional) The location of the Packer cache (Example: /tmp)</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Update the PATH environment variable to include PACKER_HOME. On Linux or macOS, add
<code>export PATH=$PACKER_HOME:$PATH</code> to the shell environment. To do this on Windows, press
<strong>Win</strong> &gt; <strong>Run&#8230;&#8203;</strong> and enter <code>sysdm.cpl</code>. On the <em>Advanced</em> tab select "Environment Variables".
Edit the user-level PATH variable by appending <code>;%PACKER_HOME%</code> to the end (don&#8217;t omit the semicolon).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="virtualbox">VirtualBox</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="overview">Overview</h3>
<div class="paragraph">
<p><a href="https://www.virtualbox.org/">VirtualBox</a> is a freely available virtualization product
that runs on Windows, Linux, and Mac hosts. It supports a wide variety of guest operating
systems and is very useful in creating development or test environments. The Packer
template will create a complete, ready-to-run TEAM Engine installation that contains
the desired set of OGC test suites. The output is a "virtual appliance" (in the standard
<a href="http://www.dmtf.org/standards/ovf">OVF format</a>) that can be imported into VirtualBox.</p>
</div>
</div>
<div class="sect2">
<h3 id="install_virtualbox">Install VirtualBox</h3>
<div class="paragraph">
<p>To install VirtualBox, download a suitable <a href="https://www.virtualbox.org/wiki/Downloads">installation package</a> for
your host environment; see the user manual for <a href="https://www.virtualbox.org/manual/ch02.html">installation instructions</a>.
When installation is complete, set the following user environment variable:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">VBOX_USER_HOME</dt>
<dd>
<p>The location where virtual machines will be created (Example: /srv/virtualbox)</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>By default virtual machines will be created in a subdirectory below the user home directory. The
environment variable <code>VBOX_USER_HOME</code> overrides the default configuration to specify an alternative
location.</p>
</div>
</div>
<div class="sect2">
<h3 id="create_and_import_the_image">Create and import the image</h3>
<div class="paragraph">
<p>The Packer templates can be downloaded from GitHub as described in the introduction. Alternatively, if
Git is installed you can clone the <a href="https://github.com/opengeospatial/teamengine">teamengine repository</a>.
The template file (teamengine-virtualbox.json) is in the src/main/config/packer/ directory within the
teamengine-virtualization module. Or build teamengine (<code>mvn package</code>) to generate the packer assembly,
an archive that contains the templates and supporting files; it can be found in the teamengine-virtualization/target
directory (a ZIP/GZIP file named teamengine-virtualization-${version}-packer).</p>
</div>
<div class="paragraph">
<p>The template defines several user variables that can be overridden from the command line or a file;
see <a href="https://www.packer.io/docs/templates/user-variables.html" class="bare">https://www.packer.io/docs/templates/user-variables.html</a>). These are listed in the table below,
along with their default values.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Template variables</caption>
<colgroup>
<col style="width: 20%;"/>
<col style="width: 20%;"/>
<col style="width: 60%;"/>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Variable</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">te_version</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"4.10"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The desired version of the TEAM Engine web application <a href="http://search.maven.org/#search%7Cga%7C1%7Ca%3A%22teamengine-web%22">available at Maven Central</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ets_resources_release</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"16.11.24"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The desired <a href="https://github.com/opengeospatial/ets-resources/releases">ets-resources release version</a>;
this project aggregates all test suite dependencies. If not specified, the latest snapshot (tip of the master branch) will be used.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">use_oracle_jdk</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"false"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether or not to use the Oracle JDK (which is subject to a
<a href="http://www.oracle.com/technetwork/java/javase/terms/license/index.html">license agreement</a>).
If not, OpenJDK will be used.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">iso_url</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"http://pubmirrors.dal.corespace.com/centos/7/isos/x86_64/CentOS-7-x86_64-Minimal-1511.iso"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A URL referring to the base ISO installation image.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Any of the template variables can be overridden by a command-line assignment. For example, if a
local copy of the base installation image exists it can be referenced using a file URL (the
final image will be created more quickly if the base image doesn&#8217;t have to be downloaded).
To create the virtual appliance, simply change to the directory containing the Packer template
and execute the <code>packer build</code> command in a shell console.</p>
</div>
<div class="listingblock">
<div class="title">Example: Build appliance from a local ISO image</div>
<div class="content">
<pre>packer build -var iso_url=file:///tmp/CentOS-7-x86_64-Minimal-1511.iso teamengine-virtualbox.json</pre>
</div>
</div>
<div class="paragraph">
<p>The appliance will be created in the "output-teamengine-virtualbox" subdirectory. The base
operating system is <a href="https://www.centos.org/">CentOS</a> 7.2 (more specifically, the minimal
distribution that is intended for headless operation without a GUI). To run it, start VirtualBox
and perform the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Choose <strong>File &gt; Import Appliance&#8230;&#8203;</strong> and select the *.ovf file</p>
</li>
<li>
<p>When the import is completed, select the newly created virtual machine and press "Start"</p>
</li>
<li>
<p>When the boot sequence finishes, login using an SSH client to localhost:2222&#8212;&#8203;or use the
VirtualBox terminal&#8212;&#8203;with the TEAM Engine user credentials (see Note 1)</p>
</li>
<li>
<p>To start or stop Tomcat, execute this command:  <code>sudo systemctl {start|stop} tomcat-jsvc</code></p>
</li>
<li>
<p>The main TEAM Engine web app is available at http://localhost:8888/teamengine (see Note 2)</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note 1</div>
</td>
<td class="content">
<div class="paragraph">
<p>The user credentials are specified in the Packer template (<code>ssh_name</code>, <code>ssh_pass</code>). This is a
normal user account with 'sudo' privileges.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note 2</div>
</td>
<td class="content">
<div class="paragraph">
<p>The VM runs on a private internal network using the default networking mode: network address
translation (NAT); this prevents all direct inbound connections, but not outbound connections.
Some port forwarding rules are created in order to allow remote access to the SSH server (via
localhost:2222) and the Tomcat web container (via localhost:8888).</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="amazon_ec2">Amazon EC2</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="overview_2">Overview</h3>
<div class="paragraph">
<p>Amazon Web Services (AWS) is a diverse platform of services that offer computing, storage, and
networking capabilities in a public cloud environment. Amazon Elastic Compute Cloud (EC2) is a
constituent service that provides dynamic infrastructure as a service (IaaS). Virtual servers
can be created, launched, configured, and managed as needed.</p>
</div>
</div>
<div class="sect2">
<h3 id="preparation">Preparation</h3>
<div class="paragraph">
<p>Before building an image, an Amazon Web Services (AWS) account must be available to use. If not,
<a href="https://portal.aws.amazon.com/gp/aws/developer/registration/">sign up for an AWS account</a>. The Packer
template complies with the restrictions of the <a href="https://aws.amazon.com/free/">free tier</a> so you will
not be charged unless your usage exceeds the stipulated limits. It is strongly recommended to <strong>not</strong>
use the root account (that is, the account owner). Instead, create a separate AWS Identity
and Access Management (IAM) user to interact with AWS. For guidance about how to do this, see
<a href="http://docs.aws.amazon.com/IAM/latest/UserGuide/getting-started_create-admin-group.html">Creating Your First IAM Admin User and Group</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note 3</div>
</td>
<td class="content">
<div class="paragraph">
<p>The AWS Free Tier offerings are available to new AWS customers for 12 months following the sign-up
date. It allows up to 750 hours usage per month of a moderately small instance (instance type "t2.micro":
1 vCPU, 1 GiB memory). Note that the monthly allotment for Linux and Microsoft Windows instances is counted
separately. Usage that exceeds the free tier limits is subject to billing. For more information, see
<a href="http://docs.aws.amazon.com/awsaccountbilling/latest/aboutv2/billing-free-tier.html">Using the Free Tier</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You will need the security credentials for the IAM user; specifically, the <a href="https://aws.amazon.com/developers/access-keys/">access keys</a>
required to send requests using various AWS APIs. Set them as the values of the environment variables
shown below (which are also supported by the AWS command-line interface). The Packer template will
obtain the credentials from these environment variables:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">AWS_ACCESS_KEY_ID</dt>
<dd>
<p><em>Access Key ID</em> (Example: AKIAIOSFODNN7EXAMPLE)</p>
</dd>
<dt class="hdlist1">AWS_SECRET_ACCESS_KEY</dt>
<dd>
<p><em>Secret Access Key</em> (Example: wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY)</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The source image is the official <a href="https://wiki.centos.org/Cloud/AWS">CentOS 7 HVM image</a>, which is
freely available from the AWS Marketplace. However, a subscription is required in order to access it.
Visit the <a href="http://aws.amazon.com/marketplace/pp?sku=aw0evgkw8e5c1q413zgy5pjce">AWS Marketplace page</a>
for the official CentOS 7 image. Click "Continue" and select the "Manual Launch" tab. Then click
"Accept Software Terms" in order to subscribe and enable access in any supported region.</p>
</div>
</div>
<div class="sect2">
<h3 id="create_and_register_the_image">Create and register the image</h3>
<div class="paragraph">
<p>The same template variables as defined for the VirtualBox image apply here. To create and register
the image, change to the directory containing the Packer template and execute this command in a shell
console:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>packer build teamengine-aws.json</pre>
</div>
</div>
<div class="paragraph">
<p>When the process is completed, the image will appear in the AWS EC2 console&#8212;&#8203;under IMAGES/AMIs&#8212;&#8203;for
the "N. Virginia" region (us-east-1). Note that the image will be marked as private, so it can
only be launched by the owning account. If you have installed and configured the
<a href="http://docs.aws.amazon.com/cli/latest/userguide/">AWS command-line tools</a>, run the <code>describe-images</code>
command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>aws ec2 describe-images --owners self --region us-east-1</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="launch_the_image">Launch the image</h3>
<div class="paragraph">
<p>An instance can be launched from the EC2 dashboard by selecting the image and clicking "Launch".
Access via SSH is permitted from anywhere by default, but the source IP address can be restricted
to a single address or an address range (in CIDR notation: 192.168.0.0/16). When the instance
reaches the "running" state it will appear in the console under INSTANCES/Instances. The public
hostname and IP address will be displayed on the "Description" tab. Connect via SSH and login
as 'centos' using the key specified at launch. The server may be stopped and started as needed
by selecting the appropriate action on the <em>Actions &gt; Instance State</em> submenu.</p>
</div>
<div class="paragraph">
<p>Execute this command to start or stop the Tomcat web container:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo systemctl {start|stop} tomcat-jsvc</pre>
</div>
</div>
<div class="paragraph">
<p>The main TEAM Engine web application will be available at &lt;http://{ip-address}:8080/teamengine/&gt;.
However, no in-bound HTTP traffic is permitted by default. A firewall rule must be added either
when launching the instance or by editing the security group that applies to the running instance.
To do the latter, on the "Description" tab select the security group and choose the <em>Actions &gt; Edit
inbound rules</em> submenu; add a custom TCP rule for port 8080.</p>
</div>
</div>
</div>
</div>
        </div>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>Copyright &copy;2024
<a href="http://www.opengeospatial.org/">Open Geospatial Consortium</a>.
All rights reserved.</p>
        </div>
        </div>
    </footer>
    </body>
</html>